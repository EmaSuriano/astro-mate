---
import ArticleCard from "../components/ArticleCard.astro";
import Title from "../components/Title.astro";
import Wave from "../components/Wave.astro";
import type { Config } from "../types";
import { articleListSchema } from "../validator";

type Props = Required<Pick<Config, "devToUser">>;

const { devToUser } = Astro.props as Props;

const url = `https://dev.to/api/articles?username=${devToUser}&per_page=6`;

const articles = await fetch(url)
  .then((res) => res.json())
  .then(articleListSchema.parse);
---

<Wave direction="bottom" fill="fill-base-200" />

<section class="hero min-h-screen bg-base-200" id="writing">
  <div class="hero-content max-w-screen-xl z-10">
    <div class="flex flex-col gap-8">
      <Title href="#writing" label="Writing ✍️" />

      <div
        class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 sm:gap-4 lg:gap-8"
      >
        {articles.map((article) => <ArticleCard article={article} />)}
      </div>
    </div>
  </div>
</section>
